@import "tailwindcss";

/* --- Theme Configuration (Tailwind 4) --- */
@theme {
  --color-mc-1: #6366f1; /* Indigo */
  --color-mc-2: #3b82f6; /* Blue */
  --color-mc-3: #06b6d4; /* Cyan */
  --color-mc-4: #10b981; /* Emerald */
  --color-mc-5: #84cc16; /* Lime */
  --color-mc-6: #eab308; /* Yellow */
  --color-mc-7: #f97316; /* Orange */
  --color-mc-8: #f43f5e; /* Rose */
  --color-mc-9: #ef4444; /* Red */
  --color-mc-10: #a855f7; /* Purple */

  --color-neon-blue: #3b82f6;
  --color-neon-orange: #f59e0b;
  --color-neon-green: #10b981;
  --color-neon-red: #ef4444;
  --color-neon-rose: #f43f5e;
  --color-neon-indigo: #6366f1;
  --color-neon-purple: #8b5cf6;
  --color-neon-magenta: #d946ef;
  --color-neon-cyan: #06b6d4;
  --color-neon-lime: #84cc16;

  /* Opacity variants for backgrounds using color-mix (Modern CSS) */
  --bg-neon-blue: color-mix(in srgb, var(--color-neon-blue), transparent 85%);
  --bg-neon-orange: color-mix(
    in srgb,
    var(--color-neon-orange),
    transparent 85%
  );
  --bg-neon-green: color-mix(in srgb, var(--color-neon-green), transparent 85%);

  --spacing-queue: 12.5%;
  --spacing-lock: 37.5%;
  --spacing-work: 62.5%;
  --spacing-done: 87.5%;
}

/* --- Base Infrastructure --- */
[x-cloak] {
  display: none !important;
}

body {
  background-color: #0a0a0a;
  color: #e5e5e5;
  margin: 0;
  overflow: hidden;
  @apply h-screen flex flex-col;
}

/* --- Pipeline Component --- */
#pipeline {
  background-color: transparent;
  background-image: radial-gradient(
    rgba(255, 255, 255, 0.03) 1px,
    transparent 1px
  );
  background-size: 30px 30px;
  position: relative;
  overflow: hidden;

  /* Vertical Divider Lines */
  &::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 20;
    background-image:
      linear-gradient(
        to right,
        transparent 24.9%,
        rgba(255, 255, 255, 0.05) 25%,
        transparent 25.1%
      ),
      linear-gradient(
        to right,
        transparent 49.6%,
        color-mix(in srgb, var(--color-neon-blue), transparent 80%) 49.7%,
        rgba(255, 255, 255, 0.6) 50%,
        color-mix(in srgb, var(--color-neon-blue), transparent 80%) 50.3%,
        transparent 50.4%
      ),
      linear-gradient(
        to right,
        transparent 74.9%,
        rgba(255, 255, 255, 0.05) 75%,
        transparent 75.1%
      );
  }

  /* LOD Mode: Star Dust */
  &[data-view-mode="dot"] .task {
    font-size: 0 !important;
    border: none !important;
    border-radius: 50% !important;
    clip-path: none !important;
    box-shadow: 0 0 6px var(--task-color, currentColor) !important;
  }
}

/* --- Background Sections --- */
.pipeline-background {
  @apply absolute inset-0 flex z-0 pointer-events-none;
  background-color: #080808;

  .zone-bg {
    @apply h-full transition-all duration-500 w-1/4;
    background-repeat: no-repeat;
    background-size: 100% 100%;
    border-right: 1px solid rgba(255, 255, 255, 0.05);

    &:hover {
      filter: brightness(1.5);
    }

    &.zone-queue {
      background: linear-gradient(
        180deg,
        var(--bg-neon-blue) 0%,
        transparent 70%
      );
    }

    &.zone-lock {
      background: linear-gradient(
        180deg,
        var(--bg-neon-orange) 0%,
        transparent 70%
      );
      border-right: 2px solid rgba(255, 255, 255, 0.2) !important;
    }

    &.zone-work {
      background: linear-gradient(
        180deg,
        var(--bg-neon-green) 0%,
        transparent 70%
      );
    }

    &.zone-done {
      background: linear-gradient(
        180deg,
        rgba(255, 255, 255, 0.05) 0%,
        transparent 100%
      );
      border-right: none;
    }
  }
}

/* --- UI Elements --- */
.status-block {
  @apply flex items-center gap-2 justify-end;

  .status-dot {
    @apply w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse transition-all duration-300;
  }

  .status-text {
    @apply text-gray-500 font-mono text-[10px] uppercase transition-colors;
  }

  &.is-online {
    .status-dot {
      @apply bg-green-500 shadow-[0_0_8px_#22c55e] animate-none;
    }
    .status-text {
      @apply text-green-400;
    }
  }
}

.hud-shape-preview {
  @apply w-4 h-4 flex items-center justify-center text-[8px] font-black text-white transition-all duration-200 border border-white/10;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
  border-radius: 3px;

  &.is-active {
    @apply ring-1 ring-white/50 scale-125;
    box-shadow: 0 0 10px rgba(255, 255, 255, 0.4);
    filter: brightness(1.2);
  }
}

/* --- Controls --- */
.task-button {
  @apply flex items-center justify-center rounded-sm border font-mono text-[10px] font-black uppercase tracking-tighter transition-all duration-200 active:scale-95;
  background: rgba(10, 10, 10, 0.8);
  border-color: color-mix(in srgb, var(--color-neon-green), transparent 80%);
  color: color-mix(in srgb, var(--color-neon-green), transparent 40%);

  &:disabled {
    @apply opacity-25 cursor-not-allowed grayscale-[0.8];
    background: rgba(20, 20, 20, 0.5);
    border-color: #333 !important;
    color: #888 !important;
    box-shadow: none !important;
    text-shadow: none !important;
    filter: brightness(0.8);

    // Disable hover effects
    &:hover {
      background: rgba(20, 20, 20, 0.5);
      box-shadow: none !important;
      @apply border-gray-800;
    }

    // Optional: add "Locked" feel
    &::after {
      content: " [LOCKED]";
      font-size: 8px;
      opacity: 0.5;
    }
  }

  &:hover {
    @apply text-white border-green-500;
    background: color-mix(in srgb, var(--color-neon-green), transparent 85%);
    box-shadow: 0 0 15px
      color-mix(in srgb, var(--color-neon-green), transparent 60%);
  }

  /* Full class name required for native nesting */
  &.task-button-warning {
    border-color: color-mix(in srgb, var(--color-neon-orange), transparent 70%);
    color: color-mix(in srgb, var(--color-neon-orange), transparent 30%);
    &:hover {
      border-color: var(--color-neon-orange);
      box-shadow: 0 0 20px
        color-mix(in srgb, var(--color-neon-orange), transparent 60%);
    }
  }

  &.task-button-danger {
    @apply italic;
    border-color: color-mix(in srgb, var(--color-neon-red), transparent 70%);
    color: color-mix(in srgb, var(--color-neon-red), transparent 20%);
    &:hover {
      @apply bg-red-600 text-white border-red-500;
      box-shadow: 0 0 25px
        color-mix(in srgb, var(--color-neon-red), transparent 40%);
    }
  }
}

#max-concurrent-slider {
  @apply appearance-none bg-[#1a1a1a] h-1 rounded-full outline-none;
  &::-webkit-slider-thumb {
    @apply appearance-none w-3 h-3 bg-green-500 rounded-full cursor-pointer border-none shadow-[0_0_10px_rgba(34,197,94,0.8)];
  }
}

/* --- Terminal & Logs --- */
#log-panel.log-panel-disabled {
  @apply opacity-20 grayscale contrast-[0.8] pointer-events-none transition-all duration-500;
}

.worker-bar {
  @apply w-3 h-1 bg-[#222] rounded-full transition-all duration-300;
  &.flash-success {
    animation: flash-green 0.4s ease-out forwards;
  }
  &.flash-error {
    animation: flash-red 0.4s ease-out forwards;
  }
}

@keyframes flash-green {
  0% {
    background: #22c55e;
    box-shadow: 0 0 10px #22c55e;
  }
  100% {
    background: #222;
  }
}
@keyframes flash-red {
  0% {
    background: #ef4444;
    box-shadow: 0 0 10px #ef4444;
  }
  100% {
    background: #222;
  }
}

/* --- Zone Labels Positioning --- */
.zone-label {
  @apply absolute top-6 font-black tracking-widest uppercase text-[10px] opacity-80 z-20 pointer-events-none;
  transform: translateX(-50%);
  text-shadow: 0 0 10px currentColor;

  &.label-queue {
    left: var(--spacing-queue);
  }
  &.label-lock {
    left: var(--spacing-lock);
  }
  &.label-work {
    left: var(--spacing-work);
  }
  &.label-done {
    left: var(--spacing-done);
  }
}

/* --- HUD Geometry Map (Manual classes for native compatibility) --- */
.hud-item[data-mc="1"] .hud-shape-preview {
  background: var(--color-mc-1);
}
.hud-item[data-mc="2"] .hud-shape-preview {
  background: var(--color-mc-2);
}
.hud-item[data-mc="3"] .hud-shape-preview {
  background: var(--color-mc-3);
}
.hud-item[data-mc="4"] .hud-shape-preview {
  background: var(--color-mc-4);
}
.hud-item[data-mc="5"] .hud-shape-preview {
  background: var(--color-mc-5);
}
.hud-item[data-mc="6"] .hud-shape-preview {
  background: var(--color-mc-6);
}
.hud-item[data-mc="7"] .hud-shape-preview {
  background: var(--color-mc-7);
}
.hud-item[data-mc="8"] .hud-shape-preview {
  background: var(--color-mc-8);
}
.hud-item[data-mc="9"] .hud-shape-preview {
  background: var(--color-mc-9);
}
.hud-item[data-mc="10"] .hud-shape-preview {
  background: var(--color-mc-10);
}

/* --- Toast Notification (Compact Mode) --- */
.toast {
  --toast-color: #10b981; // Default green

  @apply fixed top-5 right-5 bg-[#111] text-white rounded-md shadow-2xl z-[1000] pointer-events-none uppercase tracking-wider;

  // Compact layout
  padding: 8px 16px;
  font-family:
    ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
    "Courier New", monospace;
  font-size: 10px;
  border-left: 3px solid var(--toast-color);

  // Animation state
  transform: translateX(180%);
  transition: transform 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);

  &.show {
    transform: translateX(0);
  }

  .toast-brand {
    color: var(--toast-color);
    @apply font-black mr-1;
  }

  .toast-msg {
    @apply text-gray-400;
  }
}
